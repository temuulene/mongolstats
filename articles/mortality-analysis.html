<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Mortality Seasonality in Mongolia: An Evidence-Based Analysis • mongolstats</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Inter_Tight-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mortality Seasonality in Mongolia: An Evidence-Based Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mongolstats</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/getting-started.html">Getting Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/discovery.html">Discovering Public Health Data</a></li>
    <li><a class="dropdown-item" href="../articles/mapping.html">Spatial Epidemiology with mongolstats</a></li>
    <li><a class="dropdown-item" href="../articles/ub-health-environment.html">Ulaanbaatar District-Level Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/environmental-surveillance.html">Environmental Data Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/mortality-analysis.html">Mortality Seasonality Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/temuulene/mongolstats" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Mortality Seasonality in Mongolia: An Evidence-Based Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/temuulene/mongolstats/blob/main/vignettes/mortality-analysis.Rmd" class="external-link"><code>vignettes/mortality-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>mortality-analysis.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://temuulene.github.io/mongolstats/">mongolstats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nso_options.html">nso_options</a></span><span class="op">(</span>mongolstats.lang <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Global theme with proper margins to prevent text cutoff</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_set</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>      plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>      plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, color <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span>,</span>
<span>      legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>      legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>A recent social media post claimed that <strong>“the highest deaths
are occurring in December”</strong> in Mongolia, with speculation that
this might be due to New Year celebrations. This vignette applies
rigorous epidemiological methods to investigate this claim, while also
considering the significant impact of the COVID-19 pandemic
(2020-2022).</p>
<div class="section level3">
<h3 id="key-questions">Key Questions<a class="anchor" aria-label="anchor" href="#key-questions"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Is there a true December mortality peak?</strong> Do deaths
genuinely peak in December compared to other months?</li>
<li>
<strong>How did COVID-19 impact mortality?</strong> Did lockdowns
and the subsequent waves alter seasonal patterns?</li>
<li>
<strong>What causes the seasonality?</strong> Is it winter-related
(cardiovascular, respiratory) or behavioral?</li>
</ol>
</div>
<div class="section level3">
<h3 id="mongolias-context">Mongolia’s Context<a class="anchor" aria-label="anchor" href="#mongolias-context"></a>
</h3>
<ul>
<li>
<strong>Extreme Winter</strong>: Temperatures reach -40°C,
increasing cardiovascular stress and respiratory risks.</li>
<li>
<strong>COVID-19 Timeline</strong>:
<ul>
<li>
<strong>2020</strong>: Strict border closures and internal lockdowns
(prevention phase).</li>
<li>
<strong>2021</strong>: Community transmission, major lockdowns, and
vaccination campaigns.</li>
<li>
<strong>2022</strong>: Reopening and normalization.</li>
</ul>
</li>
</ul>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="data-sources">Data Sources<a class="anchor" aria-label="anchor" href="#data-sources"></a>
</h2>
<p>We use three complementary datasets from NSO:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Table</th>
<th align="left">Description</th>
<th align="left">Granularity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">DT_NSO_2100_027V2</td>
<td align="left">Deaths by aimag and month</td>
<td align="left">Monthly</td>
</tr>
<tr class="even">
<td align="left">DT_NSO_2100_027V3</td>
<td align="left">Hospital deaths by aimag and month</td>
<td align="left">Monthly</td>
</tr>
<tr class="odd">
<td align="left">DT_NSO_2100_027V1</td>
<td align="left">Deaths by leading cause, region, year</td>
<td align="left">Annual</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level2">
<h2 id="monthly-death-patterns">1. Monthly Death Patterns<a class="anchor" aria-label="anchor" href="#monthly-death-patterns"></a>
</h2>
<div class="section level3">
<h3 id="fetching-and-preparing-data">Fetching and Preparing Data<a class="anchor" aria-label="anchor" href="#fetching-and-preparing-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get monthly death data for all regions</span></span>
<span><span class="va">death_tbl</span> <span class="op">&lt;-</span> <span class="st">"DT_NSO_2100_027V2"</span></span>
<span></span>
<span><span class="co"># Get all available months</span></span>
<span><span class="va">months_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nso_dim_values.html">nso_dim_values</a></span><span class="op">(</span><span class="va">death_tbl</span>, <span class="st">"Month"</span>, labels <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dynamic year filtering (from 2015 to current year)</span></span>
<span><span class="va">current_year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">years_regex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fl">2015</span><span class="op">:</span><span class="va">current_year</span>, collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span></span>
<span><span class="va">year_pattern</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"^("</span>, <span class="va">years_regex</span>, <span class="st">")-"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">months_filtered</span> <span class="op">&lt;-</span> <span class="va">months_meta</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">year_pattern</span>, <span class="va">label_en</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fetch national-level deaths (Region code "0" = total)</span></span>
<span><span class="va">deaths_monthly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nso_data.html">nso_data</a></span><span class="op">(</span></span>
<span>  tbl_id <span class="op">=</span> <span class="va">death_tbl</span>,</span>
<span>  selections <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Region"</span> <span class="op">=</span> <span class="st">"0"</span>,</span>
<span>    <span class="st">"Month"</span> <span class="op">=</span> <span class="va">months_filtered</span><span class="op">$</span><span class="va">code</span></span>
<span>  <span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="st">"en"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parse dates and extract components</span></span>
<span><span class="va">deaths_monthly</span> <span class="op">&lt;-</span> <span class="va">deaths_monthly</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Month_en</span>, <span class="st">"-01"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    month_name <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span>, label <span class="op">=</span> <span class="cn">TRUE</span>, abbr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="co"># CRITICAL: Normalize for days in month to avoid calendar artifacts</span></span>
<span>    <span class="co"># February (28 days) would otherwise appear artificially low vs 31-day months</span></span>
<span>    days_in_month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/days_in_month.html" class="external-link">days_in_month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    daily_avg <span class="op">=</span> <span class="va">value</span> <span class="op">/</span> <span class="va">days_in_month</span>,</span>
<span>    <span class="co"># Create explicit labels for plotting to avoid TRUE/FALSE legends</span></span>
<span>    Month_Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">month</span> <span class="op">==</span> <span class="fl">12</span>, <span class="st">"December"</span>, <span class="st">"Other Months"</span><span class="op">)</span>,</span>
<span>    Season <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"Winter (Nov-Mar)"</span>, <span class="st">"Non-Winter"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, <span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2015</span>, <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2024</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p><strong>Methodological Note:</strong> All analyses use <strong>daily
average deaths</strong> (total deaths ÷ days in month) rather than raw
monthly counts. This prevents calendar artifacts where shorter months
(February = 28 days) appear to have lower mortality than longer months
(January/December = 31 days).</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="time-series-visualization-with-covid-19-context">Time Series Visualization with COVID-19 Context<a class="anchor" aria-label="anchor" href="#time-series-visualization-with-covid-19-context"></a>
</h3>
<p>We overlay the major COVID-19 phases to understand anomalies in the
trend.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define COVID-19 Periods for annotation</span></span>
<span><span class="va">covid_periods</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">Start</span>, <span class="op">~</span><span class="va">End</span>, <span class="op">~</span><span class="va">Phase</span>, <span class="op">~</span><span class="va">Color</span>,</span>
<span>  <span class="st">"2020-01-27"</span>, <span class="st">"2020-11-11"</span>, <span class="st">"Prevention (No Local Cases)"</span>, <span class="st">"#e8f5e9"</span>,</span>
<span>  <span class="st">"2020-11-12"</span>, <span class="st">"2021-05-08"</span>, <span class="st">"Lockdowns &amp; First Wave"</span>, <span class="st">"#ffebee"</span>,</span>
<span>  <span class="st">"2021-05-09"</span>, <span class="st">"2022-02-16"</span>, <span class="st">"Delta/Omicron Waves"</span>, <span class="st">"#fff3e0"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Start</span>, <span class="va">End</span><span class="op">)</span>, <span class="va">as.Date</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate y-range for shading to ensure visibility in Plotly</span></span>
<span><span class="va">y_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">deaths_monthly</span><span class="op">$</span><span class="va">daily_avg</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">y_min</span> <span class="op">&lt;-</span> <span class="va">y_range</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.9</span></span>
<span><span class="va">y_max</span> <span class="op">&lt;-</span> <span class="va">y_range</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1.1</span></span>
<span></span>
<span><span class="co"># Create time series plot with COVID-19 phase annotations</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">deaths_monthly</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">daily_avg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Background shading for COVID-19 phases - provides historical context</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">covid_periods</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">Start</span>, xmax <span class="op">=</span> <span class="va">End</span>, ymin <span class="op">=</span> <span class="va">y_min</span>, ymax <span class="op">=</span> <span class="va">y_max</span>, fill <span class="op">=</span> <span class="va">Phase</span><span class="op">)</span>,</span>
<span>    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">0.3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Main time series line</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#2c3e50"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Highlight December points - the focus of our investigation</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">Month_Type</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2.5</span>, alpha <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Custom colors for December vs other months</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"December"</span> <span class="op">=</span> <span class="st">"#e74c3c"</span>, <span class="st">"Other Months"</span> <span class="op">=</span> <span class="st">"#3498db"</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Month Type"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Custom colors for COVID-19 phase shading</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Prevention (No Local Cases)"</span> <span class="op">=</span> <span class="st">"#a5d6a7"</span>,</span>
<span>      <span class="st">"Lockdowns &amp; First Wave"</span> <span class="op">=</span> <span class="st">"#ef9a9a"</span>,</span>
<span>      <span class="st">"Delta/Omicron Waves"</span> <span class="op">=</span> <span class="st">"#ffcc80"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"COVID-19 Phase"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 year"</span>, date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_min</span>, <span class="va">y_max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Daily Average Deaths in Mongolia (2015-2024)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Shaded = COVID-19 phases; Red = December"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Daily Average Deaths"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Source: NSO Mongolia | Normalized by days in month"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey40"</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">5</span>, r <span class="op">=</span> <span class="fl">10</span>, b <span class="op">=</span> <span class="fl">5</span>, l <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,  <span class="co"># extra margin for legends</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.box <span class="op">=</span> <span class="st">"horizontal"</span>,  <span class="co"># horizontal layout prevents cutoff</span></span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span></span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span>  <span class="co"># print static ggplot</span></span></code></pre></div>
<p><img src="mortality-analysis_files/figure-html/time-series-plot-1.png" class="r-plt" alt="" width="100%"></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li>
<strong>Pre-2020:</strong> Regular seasonal pattern with winter
peaks.</li>
<li>
<strong>2020 (Green Zone):</strong> Mortality actually
<em>decreased</em> or remained stable. Strict lockdowns likely reduced
accidents and other infectious diseases.</li>
<li>
<strong>2021 (Red/Orange Zone):</strong> A massive spike in
mortality corresponds to the Delta wave, disrupting normal
seasonality.</li>
<li>
<strong>December Dominance:</strong> When adjusting for the number
of days in the month (Daily Average), <strong>December</strong> emerges
as the consistent peak month for mortality intensity.</li>
<li>
<strong>The January Dip:</strong> Surprisingly, January frequently
appears as a local trough in the daily average data. This suggests a
“Harvesting Effect” (mortality displacement), where the sudden onset of
extreme cold in December impacts the most vulnerable population
immediately, leaving a smaller pool of high-risk individuals in
January.</li>
</ul>
</div>
<div class="section level3">
<h3 id="monthly-distribution-seasonality">Monthly Distribution (Seasonality)<a class="anchor" aria-label="anchor" href="#monthly-distribution-seasonality"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate monthly statistics using daily averages (normalized)</span></span>
<span><span class="va">monthly_stats</span> <span class="op">&lt;-</span> <span class="va">deaths_monthly</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">month</span>, <span class="va">month_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_daily <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">daily_avg</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    median_daily <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">daily_avg</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_daily <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">daily_avg</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="va">sd_daily</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>    ci_lower <span class="op">=</span> <span class="va">mean_daily</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span>,</span>
<span>    ci_upper <span class="op">=</span> <span class="va">mean_daily</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Seasonal distribution showing COVID outliers</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">deaths_monthly</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>month_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">month_name</span>, levels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">month_name</span>, y <span class="op">=</span> <span class="va">daily_avg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Jitter points FIRST so boxes appear on top for legibility</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2021</span>, <span class="st">"COVID-19 Surge (2021)"</span>, <span class="st">"Normal Year"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>, size <span class="op">=</span> <span class="fl">1.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Boxplots show typical range by season</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Season</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.7</span>, outlier.shape <span class="op">=</span> <span class="cn">NA</span>  <span class="co"># hide outliers since jitter shows them</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Winter (Nov-Mar)"</span> <span class="op">=</span> <span class="st">"#e74c3c"</span>, <span class="st">"Non-Winter"</span> <span class="op">=</span> <span class="st">"#3498db"</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Season"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"COVID-19 Surge (2021)"</span> <span class="op">=</span> <span class="st">"#8e44ad"</span>, <span class="st">"Normal Year"</span> <span class="op">=</span> <span class="st">"#7f8c8d"</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Year Type"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Seasonal Distribution of Daily Average Deaths"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Normalized by days in month (2015-2024)"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Daily Average Deaths"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">5</span>, r <span class="op">=</span> <span class="fl">10</span>, b <span class="op">=</span> <span class="fl">5</span>, l <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span>  <span class="co"># print static ggplot</span></span></code></pre></div>
<p><img src="mortality-analysis_files/figure-html/monthly-boxplot-1.png" class="r-plt" alt="" width="100%"></p>
<p><strong>Lay Interpretation:</strong> The boxplot shows the “typical”
range of daily average deaths for each month (normalized by days in
month).</p>
<ul>
<li>
<strong>Winter Highs:</strong> The red boxes (Nov-Mar) are generally
higher than the blue boxes.</li>
<li>
<strong>December Peak:</strong> December consistently shows the
highest mortality intensity when measured as daily average deaths.</li>
<li>
<strong>The January Surprise:</strong> January often shows lower
daily average deaths than December, suggesting a “harvesting effect”
where December’s cold shock claims the most vulnerable first.</li>
<li>
<strong>Outliers:</strong> The purple dots high above the boxes
represent the COVID-19 surge year (2021).</li>
</ul>
</div>
<div class="section level3">
<h3 id="monthly-averages-with-confidence-intervals">Monthly Averages with Confidence Intervals<a class="anchor" aria-label="anchor" href="#monthly-averages-with-confidence-intervals"></a>
</h3>
<p>To be more precise, we look at the average number of deaths for each
month with “confidence intervals” (the error bars).</p>
<blockquote>
<p><strong>Note:</strong> Confidence intervals are calculated assuming
independence and are for illustrative purposes. Time-series
autocorrelation is not accounted for here, which may result in narrower
intervals than a more rigorous analysis would produce.</p>
</blockquote>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify peak month (using daily averages)</span></span>
<span><span class="va">peak_month</span> <span class="op">&lt;-</span> <span class="va">monthly_stats</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mean_daily</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mean_daily</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">trough_month</span> <span class="op">&lt;-</span> <span class="va">monthly_stats</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mean_daily</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">mean_daily</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Monthly means bar chart with confidence intervals</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">monthly_stats</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    month_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">month_name</span>, levels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span>,</span>
<span>    bar_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">month_name</span> <span class="op">==</span> <span class="va">peak_month</span><span class="op">$</span><span class="va">month_name</span>, <span class="st">"Peak Month"</span>, <span class="st">"Other Months"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">month_name</span>, y <span class="op">=</span> <span class="va">mean_daily</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">bar_type</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">ci_lower</span>, ymax <span class="op">=</span> <span class="va">ci_upper</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.3</span>, color <span class="op">=</span> <span class="st">"#2c3e50"</span>  <span class="co"># error bars show confidence intervals</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span></span>
<span>    yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">monthly_stats</span><span class="op">$</span><span class="va">mean_daily</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"grey50"</span>  <span class="co"># reference line for annual average</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Other Months"</span> <span class="op">=</span> <span class="st">"#3498db"</span>, <span class="st">"Peak Month"</span> <span class="op">=</span> <span class="st">"#e74c3c"</span><span class="op">)</span>,</span>
<span>    guide <span class="op">=</span> <span class="st">"none"</span>  <span class="co"># legend not needed - peak month is obvious</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span>, expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Average Daily Deaths with 95% Confidence Intervals"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Peak month: "</span>, <span class="va">peak_month</span><span class="op">$</span><span class="va">month_name</span>,</span>
<span>                      <span class="st">" ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">peak_month</span><span class="op">$</span><span class="va">mean_daily</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">" deaths/day)"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean Daily Deaths"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Dashed line = annual average; Normalized by days in month"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span>  <span class="co"># print static ggplot</span></span></code></pre></div>
<p><img src="mortality-analysis_files/figure-html/monthly-means-plot-1.png" class="r-plt" alt="" width="100%"></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="heat-map-year-month">2. Heat Map: Year × Month<a class="anchor" aria-label="anchor" href="#heat-map-year-month"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create heat map data using daily averages (normalized)</span></span>
<span><span class="va">heatmap_data</span> <span class="op">&lt;-</span> <span class="va">deaths_monthly</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>month_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">month_name</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">month.abb</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Calculate z-score within each year for relative comparison</span></span>
<span>    z_score <span class="op">=</span> <span class="op">(</span><span class="va">daily_avg</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">daily_avg</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">daily_avg</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Heatmap showing year-by-month mortality patterns</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">heatmap_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">month_name</span>, fill <span class="op">=</span> <span class="va">z_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span></span>
<span>    low <span class="op">=</span> <span class="st">"#3498db"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"#e74c3c"</span>,</span>
<span>    midpoint <span class="op">=</span> <span class="fl">0</span>, name <span class="op">=</span> <span class="st">"Relative\nIntensity"</span>  <span class="co"># z-score: positive = above average</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Mortality Heat Map"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Red = Higher than yearly average | Blue = Lower"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,          <span class="co"># bottom legend gives more horizontal space</span></span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="st">"cm"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span>  <span class="co"># print static ggplot</span></span></code></pre></div>
<p><img src="mortality-analysis_files/figure-html/heatmap-1.png" class="r-plt" alt="" width="100%"></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li>
<strong>December Dominance:</strong> Contrary to the “entire winter
peak” assumption, the heatmap shows that <strong>December (bottom
row)</strong> is the only month consistently in the “Red Zone” (high
mortality relative to each year’s average). <strong>January and February
(top rows)</strong> are largely neutral (white) or even low (blue),
reinforcing the finding that mortality intensity drops after the New
Year.</li>
<li>
<strong>The 2021 Delta Shock:</strong> The “COVID Column” (2021) was
not uniformly deadly. The first half of the year remained near average;
the massive excess mortality occurred specifically in <strong>September,
October, and November</strong>, visible as the dark red block in the
lower portion of that column—coinciding with the Delta wave.</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="statistical-confirmation">3. Statistical Confirmation<a class="anchor" aria-label="anchor" href="#statistical-confirmation"></a>
</h2>
<div class="section level3">
<h3 id="seasonal-decomposition-stl">Seasonal Decomposition (STL)<a class="anchor" aria-label="anchor" href="#seasonal-decomposition-stl"></a>
</h3>
<p>To rigorously separate the <strong>trend</strong>,
<strong>seasonality</strong>, and <strong>noise</strong> in mortality
data, we use STL (Seasonal and Trend decomposition using Loess). This
method is robust to outliers like the COVID-19 surge and provides a
cleaner view of the underlying seasonal pattern.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert to time series object using daily averages (normalized)</span></span>
<span><span class="va">ts_deaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="va">deaths_monthly</span><span class="op">$</span><span class="va">daily_avg</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2015</span>, <span class="fl">1</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform STL decomposition</span></span>
<span><span class="co"># s.window = "periodic" assumes seasonality is constant across years</span></span>
<span><span class="va">decomp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/stl.html" class="external-link">stl</a></span><span class="op">(</span><span class="va">ts_deaths</span>, s.window <span class="op">=</span> <span class="st">"periodic"</span>, robust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract components for plotting</span></span>
<span><span class="va">decomp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="va">deaths_monthly</span><span class="op">$</span><span class="va">date</span>,</span>
<span>  observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">ts_deaths</span><span class="op">)</span>,</span>
<span>  trend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">decomp</span><span class="op">$</span><span class="va">time.series</span><span class="op">[</span>, <span class="st">"trend"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  seasonal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">decomp</span><span class="op">$</span><span class="va">time.series</span><span class="op">[</span>, <span class="st">"seasonal"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  remainder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">decomp</span><span class="op">$</span><span class="va">time.series</span><span class="op">[</span>, <span class="st">"remainder"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">observed</span>, <span class="va">trend</span>, <span class="va">seasonal</span>, <span class="va">remainder</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"component"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    component <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">component</span>, </span>
<span>                       levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"observed"</span>, <span class="st">"trend"</span>, <span class="st">"seasonal"</span>, <span class="st">"remainder"</span><span class="op">)</span>,</span>
<span>                       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Observed (Daily Avg)"</span>, <span class="st">"Trend"</span>, <span class="st">"Seasonal Pattern"</span>, <span class="st">"Remainder (Noise)"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot decomposition</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">decomp_df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#2c3e50"</span>, linewidth <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"grey60"</span>, linewidth <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">component</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"2 years"</span>, date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"STL Decomposition of Daily Average Mortality"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Separating trend, seasonality, and COVID-19 anomalies"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Deaths"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Note: COVID-19 surge appears in both Trend and Remainder components"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>,</span>
<span>    panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"lines"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="mortality-analysis_files/figure-html/stl-decomposition-1.png" class="r-plt" alt="" width="100%"></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li>
<strong>Trend:</strong> Shows the overall long-term pattern. Notice
the sharp spike in 2021 (COVID-19 Delta wave) and gradual increase over
time (population growth).</li>
<li>
<strong>Seasonal Pattern:</strong> A clean, repeating annual cycle
emerges. Deaths peak in winter (Jan-Feb) and trough in summer (Jun-Aug).
This pattern is consistent across all years.</li>
<li>
<strong>Remainder:</strong> Random noise plus anomalies. The large
spikes in 2021 represent COVID-19 mortality that exceeded even the
elevated trend.</li>
</ul>
</div>
<div class="section level3">
<h3 id="seasonal-pattern-analysis">Seasonal Pattern Analysis<a class="anchor" aria-label="anchor" href="#seasonal-pattern-analysis"></a>
</h3>
<p>Let’s examine the extracted seasonal component more closely:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract one complete seasonal cycle (12 months)</span></span>
<span><span class="va">seasonal_cycle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  month <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,</span>
<span>  month_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">month.abb</span>, levels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span>,</span>
<span>  seasonal_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">decomp</span><span class="op">$</span><span class="va">time.series</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, <span class="st">"seasonal"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find peak and trough</span></span>
<span><span class="va">peak_seasonal</span> <span class="op">&lt;-</span> <span class="va">seasonal_cycle</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seasonal_effect</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">seasonal_effect</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">trough_seasonal</span> <span class="op">&lt;-</span> <span class="va">seasonal_cycle</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seasonal_effect</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">seasonal_effect</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Seasonal pattern bar chart showing above/below average by month</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">seasonal_cycle</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">month_name</span>, y <span class="op">=</span> <span class="va">seasonal_effect</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">seasonal_effect</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">"Above Average"</span>, <span class="st">"Below Average"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>           alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, color <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># zero line</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">seasonal_effect</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>        vjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">seasonal_effect</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span>  <span class="co"># inline labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Above Average"</span> <span class="op">=</span> <span class="st">"#e74c3c"</span>, <span class="st">"Below Average"</span> <span class="op">=</span> <span class="st">"#3498db"</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Seasonal Effect"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Extracted Seasonal Pattern (Daily Average Deaths)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Peak: "</span>, <span class="va">peak_seasonal</span><span class="op">$</span><span class="va">month_name</span>, <span class="st">" (+"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">peak_seasonal</span><span class="op">$</span><span class="va">seasonal_effect</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                      <span class="st">" deaths/day) | Trough: "</span>, <span class="va">trough_seasonal</span><span class="op">$</span><span class="va">month_name</span>, <span class="st">" ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">trough_seasonal</span><span class="op">$</span><span class="va">seasonal_effect</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">" deaths/day)"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Daily deaths above/below average"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span>  <span class="co"># print static ggplot</span></span></code></pre></div>
<p><img src="mortality-analysis_files/figure-html/seasonal-pattern-1.png" class="r-plt" alt="" width="100%"></p>
<blockquote>
<p><strong>Key Finding:</strong> The STL decomposition confirms that
<strong>Dec</strong> has the highest seasonal mortality, with
approximately <strong>4.4</strong> more deaths per day than the annual
average due to seasonality alone. The winter months (December–February)
form a sustained high-mortality plateau.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="harmonic-regression-results">Harmonic Regression Results<a class="anchor" aria-label="anchor" href="#harmonic-regression-results"></a>
</h3>
<p>As a complementary approach, we use harmonic regression to
mathematically model the seasonal cycle while controlling for the
overall trend.</p>
<blockquote>
<p><strong>Caveat:</strong> Harmonic regression fits a symmetrical sine
wave to the data. If the true seasonal pattern is asymmetric (e.g., a
sharp winter spike with gradual decline), the model may shift the
estimated peak to minimize overall residuals. Therefore, the STL
decomposition above is more reliable for identifying exact peak
timing.</p>
</blockquote>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit harmonic regression with annual cycle (using daily averages)</span></span>
<span><span class="va">deaths_monthly</span> <span class="op">&lt;-</span> <span class="va">deaths_monthly</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    time_index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">date</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">365.25</span>,</span>
<span>    sin_annual <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">month</span> <span class="op">/</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>    cos_annual <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">month</span> <span class="op">/</span> <span class="fl">12</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit model on daily averages</span></span>
<span><span class="va">harmonic_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">daily_avg</span> <span class="op">~</span> <span class="va">time_index</span> <span class="op">+</span> <span class="va">sin_annual</span> <span class="op">+</span> <span class="va">cos_annual</span>, data <span class="op">=</span> <span class="va">deaths_monthly</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate amplitude and phase of seasonal component</span></span>
<span><span class="va">coef_sin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">harmonic_model</span><span class="op">)</span><span class="op">[</span><span class="st">"sin_annual"</span><span class="op">]</span></span>
<span><span class="va">coef_cos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">harmonic_model</span><span class="op">)</span><span class="op">[</span><span class="st">"cos_annual"</span><span class="op">]</span></span>
<span><span class="va">amplitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">coef_sin</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">coef_cos</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">phase</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">atan2</a></span><span class="op">(</span><span class="va">coef_sin</span>, <span class="va">coef_cos</span><span class="op">)</span> <span class="op">*</span> <span class="fl">12</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span></span>
<span><span class="va">peak_month_harmonic</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">phase</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">phase</span> <span class="op">+</span> <span class="fl">12</span> <span class="kw">else</span> <span class="va">phase</span></span>
<span></span>
<span><span class="co"># Store results for display</span></span>
<span><span class="va">harmonic_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  peak_month <span class="op">=</span> <span class="va">month.name</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">peak_month_harmonic</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  amplitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">amplitude</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  r_squared <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">harmonic_model</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="statistical-findings">Statistical Findings<a class="anchor" aria-label="anchor" href="#statistical-findings"></a>
</h3>
<p>The harmonic regression model provides additional perspective on
Mongolia’s mortality seasonality:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Metric</th>
<th align="left">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Estimated Peak Month</strong></td>
<td align="left">October</td>
</tr>
<tr class="even">
<td align="left"><strong>Seasonal Amplitude</strong></td>
<td align="left">±1.4 deaths/day</td>
</tr>
<tr class="odd">
<td align="left"><strong>Model Fit (R²)</strong></td>
<td align="left">18.2% variance explained</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Methodological Note:</strong> The Harmonic Model estimates an
<strong>October</strong> peak, which may contradict the observed
<strong>December</strong> peak in the raw data. <strong>This is a model
artifact.</strong> The harmonic method forces a symmetrical sine wave
onto the data, whereas Mongolia’s mortality follows an asymmetrical
“sharp spike” pattern in early winter. The model attempts to minimize
overall error by “pulling” the estimated peak earlier to average out the
curve. <strong>The STL Decomposition above is the more reliable
indicator of peak timing.</strong></p>
</blockquote>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="cause-specific-analysis">4. Cause-Specific Analysis<a class="anchor" aria-label="anchor" href="#cause-specific-analysis"></a>
</h2>
<p>To understand <em>why</em> deaths peak in winter, we need to examine
the causes.</p>
<blockquote>
<p><strong>Note on Data Availability:</strong> Monthly mortality data by
cause is not currently available in the public NSO API. We therefore
use: 1. <strong>Annual Data</strong> to see long-term trends and the
relative burden of each cause. 2. <strong>Monthly Case Data</strong> for
respiratory diseases as a proxy for seasonal infection pressure.</p>
</blockquote>
<div class="section level3">
<h3 id="annual-trends-by-cause">Annual Trends by Cause<a class="anchor" aria-label="anchor" href="#annual-trends-by-cause"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fetch deaths by cause (annual data)</span></span>
<span><span class="va">cause_tbl</span> <span class="op">&lt;-</span> <span class="st">"DT_NSO_2100_027V1"</span></span>
<span><span class="va">indicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nso_dim_values.html">nso_dim_values</a></span><span class="op">(</span><span class="va">cause_tbl</span>, <span class="st">"Indicator"</span>, labels <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nso_dim_values.html">nso_dim_values</a></span><span class="op">(</span><span class="va">cause_tbl</span>, <span class="st">"Year"</span>, labels <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cause_deaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nso_data.html">nso_data</a></span><span class="op">(</span></span>
<span>  tbl_id <span class="op">=</span> <span class="va">cause_tbl</span>,</span>
<span>  selections <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Indicator"</span> <span class="op">=</span> <span class="va">indicators</span><span class="op">$</span><span class="va">code</span>,</span>
<span>    <span class="st">"Region"</span> <span class="op">=</span> <span class="st">"0"</span>,</span>
<span>    <span class="st">"Year"</span> <span class="op">=</span> <span class="va">years</span><span class="op">$</span><span class="va">code</span></span>
<span>  <span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="st">"en"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">Year_en</span><span class="op">)</span>,</span>
<span>    <span class="co"># Simplify cause names</span></span>
<span>    Cause <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Injury"</span>, <span class="va">Indicator_en</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Injuries &amp; Poisoning"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"cardiovascular"</span>, <span class="va">Indicator_en</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Cardiovascular"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"respiratory"</span>, <span class="va">Indicator_en</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Respiratory"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"digestive"</span>, <span class="va">Indicator_en</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Digestive"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Cancer"</span>, <span class="va">Indicator_en</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Cancer"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">Indicator_en</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Cause</span> <span class="op">!=</span> <span class="st">"Deaths"</span><span class="op">)</span> <span class="co"># Exclude total</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multi-line trend plot by cause of death</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">cause_deaths</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2015</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">Cause</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># distinct colors for each cause</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">2015</span><span class="op">:</span><span class="fl">2024</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Annual Deaths by Leading Cause (2015-2024)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Cardiovascular disease is consistently the highest killer"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of Deaths per Year"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span>  <span class="co"># print static ggplot</span></span></code></pre></div>
<p><img src="mortality-analysis_files/figure-html/cause-trends-plot-1.png" class="r-plt" alt="" width="100%"></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li>
<strong>Cardiovascular Disease (Blue Line):</strong> This is the
undisputed leading cause of death, hovering around 6,000 deaths
annually. Its dominance suggests that any seasonal spike in total deaths
is likely driven by cardiovascular stress from extreme cold.</li>
<li>
<strong>Cancer (Red Line):</strong> Consistently the second leading
cause, showing a slow, steady upward trend over the decade.</li>
<li>
<strong>Injuries (Purple Line):</strong> While significant (3rd
place), the trend is relatively flat. The lack of a massive winter spike
in this category argues <em>against</em> the theory that New Year’s
accidents are the primary driver of the December mortality peak.</li>
<li>
<strong>COVID-19 Impact:</strong> Note the sharp rise in
“Respiratory” and other categories in 2021.</li>
</ul>
</div>
<div class="section level3">
<h3 id="respiratory-infections-a-seasonal-proxy">Respiratory Infections: A Seasonal Proxy<a class="anchor" aria-label="anchor" href="#respiratory-infections-a-seasonal-proxy"></a>
</h3>
<p>Since we cannot see monthly respiratory <em>deaths</em>, we look at
monthly respiratory <em>cases</em> (e.g., flu, pneumonia) to see the
seasonal pressure.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fetch monthly respiratory disease cases</span></span>
<span><span class="va">comm_tbl</span> <span class="op">&lt;-</span> <span class="st">"DT_NSO_2100_035V1"</span></span>
<span><span class="co"># Code 12 is Respiratory infectious diseases</span></span>
<span><span class="va">resp_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nso_data.html">nso_data</a></span><span class="op">(</span></span>
<span>  tbl_id <span class="op">=</span> <span class="va">comm_tbl</span>,</span>
<span>  selections <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Indicators"</span> <span class="op">=</span> <span class="st">"12"</span>, </span>
<span>    <span class="st">"Month"</span> <span class="op">=</span> <span class="va">months_filtered</span><span class="op">$</span><span class="va">code</span></span>
<span>  <span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="st">"en"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Month_en</span>, <span class="st">"-01"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Respiratory cases boxplot by month - proxy for seasonal infection pressure</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">resp_cases</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">month</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#e74c3c"</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Seasonality of Respiratory Infections (Cases)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Monthly distribution of reported cases (2015-2024)"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Reported Cases"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span>  <span class="co"># print static ggplot</span></span></code></pre></div>
<p><img src="mortality-analysis_files/figure-html/respiratory-proxy-1.png" class="r-plt" alt="" width="100%"></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li>
<strong>Complex Seasonality:</strong> Respiratory infections do not
follow a simple winter curve. We see high case counts in
<strong>December and January</strong>, followed by a notable <strong>dip
in February</strong>, and a <strong>resurgence in May</strong> (spring
peak).</li>
<li>
<strong>The Mortality Mismatch:</strong> While the December
respiratory spike correlates with the December mortality peak, the
<strong>May respiratory spike</strong> does <em>not</em> trigger a
corresponding mortality spike (deaths are average in May). This suggests
that while respiratory illness contributes to winter deaths, it is the
<strong>combination</strong> of infection <em>plus</em> extreme cold
(Dec/Jan) that is lethal. Infection alone (in warmer May) appears less
fatal.</li>
</ul>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="regional-comparison">5. Regional Comparison<a class="anchor" aria-label="anchor" href="#regional-comparison"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fetch deaths by region</span></span>
<span><span class="va">regions_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nso_dim_values.html">nso_dim_values</a></span><span class="op">(</span><span class="va">death_tbl</span>, <span class="st">"Region"</span>, labels <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get all regions' monthly data</span></span>
<span><span class="va">regional_deaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nso_data.html">nso_data</a></span><span class="op">(</span></span>
<span>  tbl_id <span class="op">=</span> <span class="va">death_tbl</span>,</span>
<span>  selections <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Region"</span> <span class="op">=</span> <span class="va">regions_meta</span><span class="op">$</span><span class="va">code</span>,</span>
<span>    <span class="st">"Month"</span> <span class="op">=</span> <span class="va">months_filtered</span><span class="op">$</span><span class="va">code</span></span>
<span>  <span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="st">"en"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Month_en</span>, <span class="st">"-01"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    month_name <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span>, label <span class="op">=</span> <span class="cn">TRUE</span>, abbr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, <span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2015</span>, <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2024</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Classify as UB vs Rural</span></span>
<span><span class="va">regional_deaths</span> <span class="op">&lt;-</span> <span class="va">regional_deaths</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    area_type <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">Region_en</span> <span class="op">==</span> <span class="st">"Whole country"</span> <span class="op">~</span> <span class="st">"National"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Ulaanbaatar"</span>, <span class="va">Region_en</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Ulaanbaatar"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Rural (Aimags)"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">area_type</span> <span class="op">!=</span> <span class="st">"National"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregate by area type and month</span></span>
<span><span class="va">area_monthly</span> <span class="op">&lt;-</span> <span class="va">regional_deaths</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">area_type</span>, <span class="va">month</span>, <span class="va">month_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_deaths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Normalize to percentage of annual mean for comparison</span></span>
<span><span class="va">area_monthly</span> <span class="op">&lt;-</span> <span class="va">area_monthly</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">area_type</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    annual_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_deaths</span><span class="op">)</span>,</span>
<span>    pct_of_mean <span class="op">=</span> <span class="op">(</span><span class="va">mean_deaths</span> <span class="op">/</span> <span class="va">annual_mean</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Urban vs Rural seasonality comparison</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">area_monthly</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>month_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">month_name</span>, levels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">month_name</span>, y <span class="op">=</span> <span class="va">pct_of_mean</span>, color <span class="op">=</span> <span class="va">area_type</span>, group <span class="op">=</span> <span class="va">area_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># baseline reference</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pct_of_mean</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># inline labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ulaanbaatar"</span> <span class="op">=</span> <span class="st">"#e74c3c"</span>, <span class="st">"Rural (Aimags)"</span> <span class="op">=</span> <span class="st">"#3498db"</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Urban vs Rural Seasonality"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Both follow the same winter pattern"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"% Deviation from Annual Average"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span>  <span class="co"># print static ggplot</span></span></code></pre></div>
<p><img src="mortality-analysis_files/figure-html/urban-rural-comparison-1.png" class="r-plt" alt="" width="100%"></p>
<hr>
</div>
<div class="section level2">
<h2 id="hospital-vs-total-deaths">6. Hospital vs Total Deaths<a class="anchor" aria-label="anchor" href="#hospital-vs-total-deaths"></a>
</h2>
<p>Do hospital deaths show a different pattern? This can reveal
healthcare access issues.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fetch hospital deaths</span></span>
<span><span class="va">hospital_tbl</span> <span class="op">&lt;-</span> <span class="st">"DT_NSO_2100_027V3"</span></span>
<span><span class="va">hospital_months</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nso_dim_values.html">nso_dim_values</a></span><span class="op">(</span><span class="va">hospital_tbl</span>, <span class="st">"Month"</span>, labels <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter to 2015-2024</span></span>
<span><span class="va">hospital_months_filtered</span> <span class="op">&lt;-</span> <span class="va">hospital_months</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^(2015|2016|2017|2018|2019|2020|2021|2022|2023|2024)-"</span>, <span class="va">label_en</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hospital_deaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nso_data.html">nso_data</a></span><span class="op">(</span></span>
<span>  tbl_id <span class="op">=</span> <span class="va">hospital_tbl</span>,</span>
<span>  selections <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Region"</span> <span class="op">=</span> <span class="st">"0"</span>,</span>
<span>    <span class="st">"Month"</span> <span class="op">=</span> <span class="va">hospital_months_filtered</span><span class="op">$</span><span class="va">code</span></span>
<span>  <span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="st">"en"</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Month_en</span>, <span class="st">"-01"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    year <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    month_name <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">date</span>, label <span class="op">=</span> <span class="cn">TRUE</span>, abbr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"Hospital Deaths"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, <span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2015</span>, <span class="va">year</span> <span class="op">&lt;=</span> <span class="fl">2024</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine with total deaths</span></span>
<span><span class="va">comparison_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">deaths_monthly</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"All Deaths"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">year</span>, <span class="va">month</span>, <span class="va">month_name</span>, <span class="va">value</span>, <span class="va">type</span><span class="op">)</span>,</span>
<span>  <span class="va">hospital_deaths</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">year</span>, <span class="va">month</span>, <span class="va">month_name</span>, <span class="va">value</span>, <span class="va">type</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate monthly averages by type</span></span>
<span><span class="va">type_monthly</span> <span class="op">&lt;-</span> <span class="va">comparison_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">month</span>, <span class="va">month_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean_deaths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    annual_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_deaths</span><span class="op">)</span>,</span>
<span>    pct_of_mean <span class="op">=</span> <span class="op">(</span><span class="va">mean_deaths</span> <span class="op">/</span> <span class="va">annual_mean</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Hospital vs All Deaths seasonality comparison</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">type_monthly</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>month_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">month_name</span>, levels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">month_name</span>, y <span class="op">=</span> <span class="va">pct_of_mean</span>, color <span class="op">=</span> <span class="va">type</span>, group <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># baseline</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pct_of_mean</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># inline labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"All Deaths"</span> <span class="op">=</span> <span class="st">"#2c3e50"</span>, <span class="st">"Hospital Deaths"</span> <span class="op">=</span> <span class="st">"#e74c3c"</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Hospital vs All Deaths Seasonality"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Percentage deviation from annual mean"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"% Deviation from Annual Average"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p</span>  <span class="co"># print static ggplot</span></span></code></pre></div>
<p><img src="mortality-analysis_files/figure-html/hospital-comparison-1.png" class="r-plt" alt="" width="100%"></p>
<hr>
</div>
<div class="section level2">
<h2 id="detailed-summary-statistics">7. Detailed Summary Statistics<a class="anchor" aria-label="anchor" href="#detailed-summary-statistics"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate summary statistics using daily averages</span></span>
<span><span class="va">peak_analysis</span> <span class="op">&lt;-</span> <span class="va">monthly_stats</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="op">-</span><span class="va">mean_daily</span><span class="op">)</span>,</span>
<span>    is_winter <span class="op">=</span> <span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">winter_avg</span> <span class="op">&lt;-</span> <span class="va">peak_analysis</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">is_winter</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_daily</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">summer_avg</span> <span class="op">&lt;-</span> <span class="va">peak_analysis</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">is_winter</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_daily</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">winter_excess</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">winter_avg</span> <span class="op">/</span> <span class="va">summer_avg</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># Store results for inline display</span></span>
<span><span class="va">summary_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  overall_avg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">monthly_stats</span><span class="op">$</span><span class="va">mean_daily</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  peak_month_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">peak_month</span><span class="op">$</span><span class="va">month_name</span><span class="op">)</span>,</span>
<span>  peak_deaths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">peak_month</span><span class="op">$</span><span class="va">mean_daily</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  trough_month_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">trough_month</span><span class="op">$</span><span class="va">month_name</span><span class="op">)</span>,</span>
<span>  trough_deaths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">trough_month</span><span class="op">$</span><span class="va">mean_daily</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  winter_excess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">winter_excess</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="key-statistics">Key Statistics<a class="anchor" aria-label="anchor" href="#key-statistics"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th align="left">Metric</th>
<th align="left">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Overall daily average</strong></td>
<td align="left">47.4 deaths/day</td>
</tr>
<tr class="even">
<td align="left"><strong>Peak month</strong></td>
<td align="left">Dec (50.4 deaths/day)</td>
</tr>
<tr class="odd">
<td align="left"><strong>Trough month</strong></td>
<td align="left">Jan (44.8 deaths/day)</td>
</tr>
<tr class="even">
<td align="left"><strong>Winter excess mortality</strong></td>
<td align="left">+-0.2%</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Daily average deaths are <strong>-0.2% higher</strong> in winter
months (Nov-Mar) compared to non-winter months.</p>
</blockquote>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="conclusions">8. Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>Based on the evidence, we can address the social media claim:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Does December have the highest deaths?</strong>
<ul>
<li>
<strong>Yes, the data supports this.</strong> Unlike raw counts
(where January’s 31 days inflate its ranking), the <strong>Daily
Average</strong> analysis confirms that mortality intensity peaks in
<strong>December</strong> (50.4 deaths/day). The social media claim is
statistically accurate regarding the timing.</li>
</ul>
</li>
<li>
<strong>The Winter “Shock-and-Drop” Pattern:</strong>
<ul>
<li>We observe a surprising pattern: mortality spikes sharply in
December as temperatures plummet, followed by a dip in January (44.8
deaths/day—often the annual trough in daily averages). This contradicts
the assumption that the entire winter is a sustained plateau; rather,
the <em>onset</em> of extreme winter appears to be the deadliest phase.
This is consistent with a “harvesting effect” where December’s cold
shock claims the most vulnerable individuals first.</li>
</ul>
</li>
<li>
<strong>Is it because of New Year parties?</strong>
<ul>
<li>
<strong>We cannot determine this definitively.</strong> The NSO
public API only provides <strong>annual</strong> death counts by
cause—not monthly breakdowns. Without monthly cause-of-death data, we
cannot confirm whether the December spike is driven by cardiovascular
stress, respiratory illness, injuries, or some combination. While
injuries appear to be a smaller fraction of <em>annual</em> deaths
compared to cardiovascular disease, we lack the seasonal granularity to
rule out a significant holiday-related injury spike in December
specifically.</li>
</ul>
</li>
<li>
<strong>The COVID-19 Effect:</strong>
<ul>
<li>The pandemic disrupted natural patterns. Lockdowns in 2020 actually
<em>suppressed</em> mortality, while the 2021 waves caused historic
highs. This highlights that infectious diseases (and our response to
them) are major drivers of death rates.</li>
</ul>
</li>
</ol>
<div class="section level3">
<h3 id="data-limitations">Data Limitations<a class="anchor" aria-label="anchor" href="#data-limitations"></a>
</h3>
<blockquote>
<p><strong>Important:</strong> This analysis is constrained by data
availability. The NSO public API provides: - ✅ Monthly
<strong>total</strong> deaths (which we analyzed) - ✅ Annual deaths
<strong>by cause</strong> (which shows cardiovascular dominance yearly)
- ❌ Monthly deaths <strong>by cause</strong> (not available)</p>
<p>To definitively answer <em>why</em> December mortality peaks,
researchers would need access to monthly cause-of-death data, which may
require direct collaboration with NSO or access to restricted
datasets.</p>
</blockquote>
<p><strong>Final Verdict:</strong> The social media claim that
<strong>“the highest deaths are occurring in December”</strong> is
<strong>supported by the data</strong> when properly normalized for days
in month. However, <strong>the underlying cause remains
uncertain</strong> without monthly cause-specific mortality data. The
correlation with extreme cold onset is suggestive but not
conclusive.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="appendix-reproducibility">Appendix: Reproducibility<a class="anchor" aria-label="anchor" href="#appendix-reproducibility"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] scales_1.4.0      lubridate_1.9.4   ggplot2_4.0.1     tidyr_1.3.2      </span></span>
<span><span class="co">#&gt; [5] dplyr_1.1.4       mongolstats_0.1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.6       jsonlite_2.0.0     compiler_4.5.2     tidyselect_1.2.1  </span></span>
<span><span class="co">#&gt;  [5] jquerylib_0.1.4    systemfonts_1.3.1  textshaping_1.0.4  yaml_2.3.12       </span></span>
<span><span class="co">#&gt;  [9] fastmap_1.2.0      R6_2.6.1           labeling_0.4.3     generics_0.1.4    </span></span>
<span><span class="co">#&gt; [13] curl_7.0.0         httr2_1.2.2        knitr_1.51         htmlwidgets_1.6.4 </span></span>
<span><span class="co">#&gt; [17] tibble_3.3.0       desc_1.4.3         RColorBrewer_1.1-3 bslib_0.9.0       </span></span>
<span><span class="co">#&gt; [21] pillar_1.11.1      rlang_1.1.6        cachem_1.1.0       xfun_0.55         </span></span>
<span><span class="co">#&gt; [25] S7_0.2.1           fs_1.6.6           sass_0.4.10        otel_0.2.0        </span></span>
<span><span class="co">#&gt; [29] timechange_0.3.0   cli_3.6.5          withr_3.0.2        pkgdown_2.2.0     </span></span>
<span><span class="co">#&gt; [33] magrittr_2.0.4     digest_0.6.39      grid_4.5.2         rappdirs_0.3.3    </span></span>
<span><span class="co">#&gt; [37] lifecycle_1.0.4    vctrs_0.6.5        evaluate_1.0.5     glue_1.8.0        </span></span>
<span><span class="co">#&gt; [41] farver_2.1.2       ragg_1.5.0         rmarkdown_2.30     purrr_1.2.0       </span></span>
<span><span class="co">#&gt; [45] tools_4.5.2        pkgconfig_2.0.3    htmltools_0.5.9</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Temuulen Enebish.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
